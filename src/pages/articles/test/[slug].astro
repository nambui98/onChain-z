---
import BaseLayout from "../../layout/BaseLayout.astro"
import SingleBlogItem from "../../components/SingleBlogItem.jsx"

/**
 * returning all the names of the files/pages it should generate. 
 * 
 * Since Astro uses file-based routing, 
 * it supports dynamic parameters using [bracket] notation into the filename. 
 * This allows mapping a specific file to make different routes.
 * 
 */
export async function getStaticPaths() {



    const posts = await fetch(`https://jsonplaceholder.typicode.com/posts`).then(res => res.json())
    return posts.map(post => ({ params: { slug: post.slug } }))
}

const { slug } = Astro.request.params
const postItem = await fetch(`http://localhost:1337/posts?slug=${slug}`).then(x => x.json())
---

<BaseLayout title={postItem[0]?.title}>
    <SingleBlogItem post={postItem[0]} />
</BaseLayout>