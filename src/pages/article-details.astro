---
import AppConfig from '~/AppConfig'
import BaseSEOLayout from '~/layouts/BaseSEOLayout.astro'


const articles = await Astro.glob('./articles/**/*.md') // Data Fetching: List all Markdown posts in the repo.

import PostService from '~/services/PostService'
import { Account } from '~/components/Account'
import Breadcrumbs from '~/components/Breadcrumbs'
import LeftDetail from '~/containers/ArticleDetails/LeftDetail'
import RelatedPosts from '~/containers/ArticleDetails/RelatedPosts'
import RightDetail from '~/containers/ArticleDetails/RightDetail'

import 'react-toastify/dist/ReactToastify.css'
const postService = new PostService(articles)
const mainArticles = postService.getAll().slice(0, (AppConfig.homePageSettings as any).frontPagePostLimit || 6)
const highlightArticles = postService.getHomeHighlightItems().slice(0,  (AppConfig.homePageSettings as any).frontPagePostLimit || 6)
const tiviArticles = postService.getHomeTVWidgetItems().slice(0,  (AppConfig.homePageSettings as any).frontPagePostLimit || 6)


const title = AppConfig.siteTitle
const description = AppConfig.siteSlogan
const links = [
  {
    name: 'Trang chủ',
    href: '/',
  },
  {
    name: 'Tin tức nổi bật',
    href: '/',
  },
]
const href = Astro.url.href
---

<BaseSEOLayout title={description} description={description} className="HomePage ">
    
    <main class="Detail wrapper mt4 mb4 z-2 relative sm-max:static lg:m-0 sm:mx-3">
        <Breadcrumbs links={links}/>
        <div id="root"></div>
        <!-- <Detail article={highlightArticles[0]} articles={highlightArticles}/> -->
        <div class="ArticleDetails sm-max:px-4">
            <div class="flex  border-b-1 border-gray40 pb-6 gap-8">
            <div class="w-5/7 sm-max:w-full">
                  {/* // TODO: Thach: em cần data tác giả của bài viết chuyền vào Account*/ }
                <Account client:load article={highlightArticles[0]} articles={articles as any} />
                <LeftDetail client:load article={highlightArticles[0]} href={href}/>
        </div>
                <RightDetail  article={highlightArticles[0]} articles={highlightArticles} className="w-2/7 sm-max:hidden" />
            </div>
            <RelatedPosts className="mt-10" articles={highlightArticles.slice(0, 3)} />
        </div>
    </main>
</BaseSEOLayout>
